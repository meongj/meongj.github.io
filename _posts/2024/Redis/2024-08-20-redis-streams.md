---
layout: post
title: "Redis streams"
date: 2024-08-20
categories: redis 
---




## Redis streams 란?
- Redis의 데이터 구조 중 하나
- 실시간 이벤트 데이터 처리

## 언제 사용하는가?
1. 이벤트 소싱 : 각 이벤트가 발생한 순서대로 기록되며, 나중에 이를 재생하여 상태를 복구하거나 분석
2. 실시간 데이터 처리 :센서 데이터 수집, 실시간 사용자 활동 모니터링, 실시간 로그 수집 등 시간에 민감한 데이터를 처리할 때 유용
3. 알림 시스템 : 사용자에게 실시간 알림을 제공하거나, 특정 이벤트 발생 시 트리거하여 알림을 생성하는 시스템에 적합
4. 작업 큐(Task Queue) :  대기 중인 작업을 처리하기 위한 큐

## 왜 사용 하는가?
1. 실시간성 : 실시간 데이터 처리에 최적화되어 있어, 데이터를 빠르게 기록하고 소비
2. 확장성 : 스트림 데이터는 매우 큰 양의 데이터를 처리할 수 있도록 설계 또한, 소비자 그룹을 사용하여 여러 개의 소비자가 병렬로 데이터를 처리할 수 있어 확장성이 높다
3. 복잡한 소비 모델 : 단순히 데이터를 추가하고 읽는 것뿐만 아니라, 특정 소비자가 어떤 데이터를 처리했는지 추적할 수 있어, 메시지 누락 없이 안정적으로 데이터를 처리할 수 있다


##  Redis Streams의 주요 기능
1. 레코드 추가
   - 데이터를 추가하여 로그 기록
   - 각 레코드에서는 고유한ID 부여
2. 레코드 소비
   - 기록된 로그 데이터를 소비자가 읽어 처리


## Redis Streams VS Pub/Sub의 차이점
Redis Streams와 Pub/Sub는 둘 다 메시지를 발송하고 소비하는 패턴을 제공
1. 메시지의 지속성
- Pub/Sub : 
  - 메시지가 일시적
  - 소비자가 메시지를 수신하기 위해서는 메시지 발송 시점에 반드시 구독 상태여야함
  - 메시지를 놓치면 다시 받을 수 없음
- Redis Streams
  - 메시지가 지속적 유지
  - 메시지는 스트림에 추가 된 후 삭제되거나 트리밍(trim) 되기 전까지 보존
  - 나중에라도 다시 메시지 읽을 수 있음
2. 메시지 소비 방식
- Pub/Sub :
  - 서버 측에서 구독을 관리하고, 메시지가 도착하면 자동으로 클라이언트에게 push
- Redis Streams:
  - 클라이언트가 직접 스트림을 폴링(polling)하여 메시지 가져가야함
  - 클라이언트가 능동적으로 메시지 요청해야함


* References
  https://docs.spring.io/spring-data/redis/reference/redis/redis-streams.html